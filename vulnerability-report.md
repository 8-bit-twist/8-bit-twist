# 8-Bit Twist Vulnerabilyt Report

## Vulnerabilty 1

### Access Control/Authorization

#### Exposure

Authorization and Access Control is the process of determing what functionality a user has based on their level of need-to-know.  Users are only given access to functionality that is pertinent to their authorization level.  This prevents users who are not authorized from accessing more sensitive data.

#### Repair

We implemented authorization via Roles in ASP.Net Core's Identity.  All users are assigned the User Role, and the Admin Role is assigned only to users with qualifying account information:

```
// Inject Identity into Controller

private UserManager<ApplicationUser> _userManager;

// Add qualified users to Admin role
if (*specified user email matches*)
{
    await _userManager.AddToRoleAsync(user, ApplicationRoles.Admin);
}

// Add all users to User rol
await _userManager.AddToRoleAsync(user, ApplicationRoles.Member);
```

#### Resources

https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity?view=aspnetcore-2.2&tabs=visual-studio

https://docs.microsoft.com/en-us/aspnet/core/security/authorization/roles?view=aspnetcore-2.2

https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Access_Control_Cheat_Sheet.md

## Vulnerabilty 2

### Cross-site Scripting(XSS)

#### Exposure

Cross-site Scripting is when the client-side HTML is tricked into using or accessing scripts that it would otherwise not access.  This opens up the possiblity of redirects or loggers that steal user info.

#### Repair

.NET Core has a built-in defense mechanism via tag-helpers, and the HTML attributes in Razor pages are automatically encoded when used with the @ directive.

Example from an input form:
```
<label asp-for="Product.Name"></label>
<input asp-for="Product.Name" value="@Model.Product.Name" />
<span asp-validation-for="Product.Name" class="text-danger"></span>
```

#### Resources

https://docs.microsoft.com/en-us/aspnet/core/security/cross-site-scripting?view=aspnetcore-2.2

## Vulnerabilty 3

### Password protection

#### Exposure

Stored passwords can be accessed by malicious users, granting access to Roles above the user's authorization level.  Proper storage of user passwords is vital to security.

#### Repair

.NET Core Identity impliments `PBKDF2` password hashing by default.

```
var result = await _userManager.CreateAsync(user, model.Password);
```

#### Resources

https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity?view=aspnetcore-2.2&tabs=visual-studio

https://docs.microsoft.com/en-us/aspnet/core/security/data-protection/consumer-apis/password-hashing?view=aspnetcore-2.2

## Vulnerabilty 4

### SQL Injection

#### Exposure

SQL Injection flaws occur when dynamic SQL queries are created based on user input.  The user can input a value that is recognized as a query statement and access unintended areas or functionality of the database.

#### Repair

We implemented a Model Bind property on the form that takes in user input to paramaterize the input, as well as using our Role based Authentication to allow only authorized users access to that form.  Entity Framework also has built-in preventative measures.

```
[BindProperty]
public IFormFile Image { get; set; }

[BindProperty]
public Product Product { get; set; }
```

#### Resources

https://docs.microsoft.com/en-us/sql/relational-databases/security/choose-an-authentication-mode?view=sql-server-2017#connecting-through-sql-server-authentication

https://docs.microsoft.com/en-us/aspnet/core/mvc/models/model-binding?view=aspnetcore-2.2

https://docs.microsoft.com/en-us/ef/ef6/index
